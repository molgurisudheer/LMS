<%if notice.present?%>
<div class="alert alert-success alert-dismissible fade show" role="alert">
  <%= notice %>
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<%end%>

<h1 class="h3 mb-3 font-weight-normal">Leaves</h1>
<div class="row">
  <div class="col-md-7">


    <% if !@leaves.blank? %>

      <table class="table table-striped">
        <thead>
        <tr>
          <th>From date</th>
          <th>To date</th>
          <th>Reason</th>
          <th>Status</th>
          <th colspan="3"></th>
        </tr>
        </thead>

        <tbody>
        <% @leaves.each do |leave| %>
          <tr>
            <td><%= leave.from_date %></td>
            <td><%= leave.to_date %></td>
            <td><%= leave.reason %></td>
            <td><%= leave.status %></td>

            <% if current_user.reporting_head? %>
              <td><%= link_to 'Approve', reporting_head_approve_path(leave) %></td>
              <td><%= link_to 'Reject', reporting_head_reject_path(leave) %></td>
            <% else %>
              <td><%= link_to 'Show', leave %></td>
              <% unless leave.status == "Approved" %>
                <td><%= link_to 'Edit', edit_leave_path(leave) %></td>
                <td><%= link_to 'Destroy', leave, method: :delete, data: {confirm: 'Are you sure?'} %></td>
              <% end %>
            <% end %>
          </tr>
        <% end %>
        </tbody>
      </table>
    <% else %>
      <p>You dont have applied leaves</p>
    <% end %>
  </div>
  <div class="col-md-5">

    <ul class="list-group">

      <% unless current_user.reporting_head? %>

        <li class="list-group-item d-flex justify-content-between align-items-center">Reporting Head Details:
          <ul class="list-group">
            <li class="list-group-item d-flex justify-content-between align-items-center">User Name:
              <span class="badge badge-primary badge-pill"><%= @reporting_head.username %></span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center">Email:
              <span class="badge badge-primary badge-pill"><%= @reporting_head.email %></span>
            </li>
          </ul>
        </li>

        <li class="list-group-item d-flex justify-content-between align-items-center">Leaves Credited:
          <span class="badge badge-primary badge-pill"><%= current_user.leaves_credited %></span>
        <li class="list-group-item d-flex justify-content-between align-items-center">
          Leaves Taken:
          <span class="badge badge-primary badge-pill"><%= current_user.leaves.count %></span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
          Leaves Blance:
          <span class="badge badge-primary badge-pill"><%= current_user.leaves_credited - current_user.leaves.count %></span>
        </li>
      <% end %>
    </ul>
  </div>
</div>